
<div class="z-1199 fixed inset-0 bg-black/65" (click)="closePanel()">
</div>

<div class="flex justify-center items-center">
    <div
        class="z-1200 fixed top-1/2 -translate-y-1/2 w-full max-w-9/10 sm:max-w-sm mx-auto max-h-[90vh] p-6 bg-surface dark:bg-surface-dark rounded-lg shadow-lg overflow-y-auto">
        <button (click)="closePanel()"
            class="cursor-pointer absolute top-4 right-4 text-on-surface dark:text-on-surface-dark"
            aria-label="close modal">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" stroke="currentColor"
                fill="none" stroke-width="1.4" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>

        <h2 class="text-lg font-bold dark:text-on-surface-dark">{{ registering && 'Register An Account' || 'Sign In' }}</h2>

        @if (registering) {
            <div class="flex w-full flex-col gap-1 text-on-surface dark:text-on-surface-dark mt-3">
                <label for="textInputDefault" class="w-fit pl-0.5 text-sm">First Name</label>
                <input [(ngModel)]="fname" id="textInputDefault" type="text"
                    class="w-full rounded-radius border border-outline bg-surface-alt px-2 py-2 text-sm focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:cursor-not-allowed disabled:opacity-75 dark:border-outline-dark dark:bg-surface-dark-alt/50 dark:focus-visible:outline-primary-dark"
                    name="fname" placeholder="Enter your first name" autocomplete="name" />
            </div>

            <div class="flex w-full flex-col gap-1 text-on-surface dark:text-on-surface-dark mt-3">
                <label for="textInputDefault" class="w-fit pl-0.5 text-sm">Last Name</label>
                <input [(ngModel)]="lname" id="textInputDefault" type="text"
                    class="w-full rounded-radius border border-outline bg-surface-alt px-2 py-2 text-sm focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:cursor-not-allowed disabled:opacity-75 dark:border-outline-dark dark:bg-surface-dark-alt/50 dark:focus-visible:outline-primary-dark"
                    name="lname" placeholder="Enter your last name" autocomplete="name" />
            </div>
        }

        <div class="flex w-full flex-col gap-1 text-on-surface dark:text-on-surface-dark mt-3">
            <label for="textInputDefault" class="w-fit pl-0.5 text-sm">Username</label>
            <input [(ngModel)]="username" id="textInputDefault" type="text"
                class="w-full rounded-radius border border-outline bg-surface-alt px-2 py-2 text-sm focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:cursor-not-allowed disabled:opacity-75 dark:border-outline-dark dark:bg-surface-dark-alt/50 dark:focus-visible:outline-primary-dark"
                name="username" placeholder="Enter your username" autocomplete="username" />
        </div>

        @if (registering) {
            <div class="flex w-full flex-col gap-1 text-on-surface dark:text-on-surface-dark mt-3">
                <label for="textInputDefault" class="w-fit pl-0.5 text-sm">Email</label>
                <input [(ngModel)]="email" id="textInputDefault" type="email"
                    class="w-full rounded-radius border border-outline bg-surface-alt px-2 py-2 text-sm focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:cursor-not-allowed disabled:opacity-75 dark:border-outline-dark dark:bg-surface-dark-alt/50 dark:focus-visible:outline-primary-dark"
                    name="email" placeholder="Enter your email" autocomplete="email" />
            </div>
        }

        <div class="flex w-full flex-col gap-1 text-on-surface dark:text-on-surface-dark mt-3">
            <label for="passwordInput" class="w-fit pl-0.5 text-sm">Password</label>
            <div x-data="{ showPassword: false }" class="relative">
                <input [(ngModel)]="password" [attr.type]="showPassword ? 'text' : 'password'" id="passwordInput"
                    class="w-full rounded-radius border border-outline bg-surface-alt px-2 py-2 text-sm focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:cursor-not-allowed disabled:opacity-75 dark:border-outline-dark dark:bg-surface-dark-alt/50 dark:focus-visible:outline-primary-dark"
                    name="password" autocomplete="current-password" placeholder="Enter your password" />
                <button type="button" (click)="showPassword = !showPassword"
                    class="absolute right-2.5 top-1/2 -translate-y-1/2 text-on-surface dark:text-on-surface-dark"
                    aria-label="Show password">
                    @if (!showPassword) {
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" aria-hidden="true" class="size-5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                    </svg>
                    } @else {
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" aria-hidden="true" class="size-5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                    }


                </button>
            </div>
        </div>

        <div class="flex justify-end gap-2 mt-4">
            <button (click)="toggleRegister()"
                class="cursor-pointer whitespace-nowrap rounded-radius border border-transparent text-secondary px-4 py-2 text-center text-xs font-medium tracking-wide transition hover:opacity-75 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-secondary active:opacity-100 active:outline-offset-0 dark:border-transparent dark:text-secondary-dark dark:focus-visible:outline-secondary-dark"
                type="button" aria-label="cancel">
                {{ registering && 'Sign In' || 'Register' }}
            </button>
            <button (click)="login()" 
                [disabled]="(registering && (username.length == 0 || password.length == 0 || email.length == 0 || fname.length == 0 || lname.length == 0)) || (username.length == 0 || password.length == 0)"
                class="cursor-pointer whitespace-nowrap rounded-full border border-primary bg-primary px-6 py-2 text-center text-xs font-medium tracking-wide text-on-primary transition hover:opacity-75 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary active:opacity-100 active:outline-offset-0 dark:bg-primary-dark dark:text-on-primary-dark dark:border-primary-dark dark:focus-visible:outline-primary-dark disabled:opacity-75 disabled:cursor-not-allowed"
                type="button" aria-label="send">
                {{ registering && 'Register' || 'Sign In' }}
            </button>
        </div>
    </div>

</div>

